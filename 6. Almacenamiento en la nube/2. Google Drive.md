## Versiones Nuevas (Google Drive para Desktop)

### Archivos y Rutas Clave

| Elemento                    | Ruta                                                      |
| --------------------------- | --------------------------------------------------------- |
| Carpeta raíz                | `%UserProfile%\AppData\Local\Google\DriveFS\<account_id>` |
| Metadatos                   | `metadata_sqlite_db`                                      |
| Caché de archivos           | `content_cache\` (archivos renombrados sin extensión)     |
| Preferencias raíz           | `root_preference_sqlite.db`                               |
| Letra de unidad virtual     | Punto de montaje tipo FAT32 (ej. `G:\`)                   |
| Registro de unidad asignada | `HKCU\Software\Google\DriveFS\Share\SyncTargets`          |

---

### metadata\_sqlite\_db (BD SQLite)

**Tabla `items`**
* `id`: ID del archivo en la nube.
* `stable_id`: ID interno estable.
* `local_title`: Nombre del archivo.
* `file_size`, `modified_date`, `viewed_by_me_date`, `shared_with_me_date`.
* `is_owner`, `trashed`, `is_folder`.

**Tabla `item_properties`**
* `pinned`: Archivo sin conexión.
* `local_title`: Nombre del archivo.
* `modified-date`: Hora de modificación.
* `trashed-locally`: Eliminado localmente.
* `trashed-locally-name`: Nombre del archivo borrado.
* `version-counter`: Indica si está cacheado.
* `drivefs.Zone.Identifier`: Info origen de descarga.

**Tabla `properties`**
* `account`, `account_settings`: Información serializada (protobuf).

---

### Herramientas Forenses

| Herramienta           | Descripción                                                                                  |
| --------------------- | -------------------------------------------------------------------------------------------- |
| **gMetaParse**        | Une `items` + `item_properties`, detecta archivos cacheados, salida JSON/CSV + GUI.          |
| **DriveFS Sleuth**    | Extrae hashes MD5 desde campos `proto`, decodifica protobuf, salida HTML/CSV.                |
| **CyberChef**         | Para decodificar campos protobuf manualmente (usando receta `From Hex` + `Protobuf Decode`). |
| **google-fs-recover** | Extrae archivos desde `content_cache`, calcula MD5, exporta.                                 |

---

## Archivos en caché

* Ruta: `%UserProfile%\AppData\Local\Google\DriveFS\<id>\content_cache`
* Pueden incluir archivos solo en nube.
* No tienen extensión, requiere análisis de encabezado/hash.

---

## Auditoría de Google Workspace (G Suite)

* **Disponible** en versiones Business+.
* **Duración**: 180 días por defecto (extensible vía BigQuery).
* **Exportación**: CSV desde consola o API.

| Tipos de eventos       | Filtros aplicables              |
| ---------------------- | ------------------------------- |
| Create, Edit, Download | User, Date, Item Name, Owner    |
| View, Share, Delete    | Prior Visibility, Item ID, Type |
| Rename, Move, Upload   | Visibility Change               |

**Limitaciones**:

* Retraso de 1–3 días.
* Redundancias y ambigüedades (e.g. descargas indirectas).
* Dirección IP no filtrable vía interfaz.

---

## Versiones Antiguas (Google Drive Sync)

### Rutas y Archivos Clave

| Elemento                | Ruta                                        |
| ----------------------- | ------------------------------------------- |
| Configuración           | `%AppData%\Local\Google\Drive\user_default` |
| Base de datos principal | `Snapshot.db` (SQLite3)                     |
| Logs de sincronización  | `sync_log.log`                              |
| Base de datos gráfica   | `cloud_graph\cloud_graph.db` (SQLite3)      |
| Configuración           | `sync_config.db`                            |

---

### Bases de Datos (SQLite)

* **`Snapshot.db`**:

  * Tabla `cloud_entry`: nombre (`filename`), modificación (`modified`), `checksum` (MD5), `size`.
  * Tablas `local_entry`, `local_relation`: estructura del sistema de archivos.

* **`cloud_graph.db`**:

  * Tabla `cloud_graph_entry`: nombre, modificación (epoch), tamaño, `checksum` (MD5).

* **`sync_config.db`**:

  * Tabla `data`: Email asociado, carpeta compartida, versión de Drive.

---

### Otros Artefactos

| Fuente              | Información útil                                       |
| ------------------- | ------------------------------------------------------ |
| Event Log (ID 1033) | Instalación de Google Drive                            |
| Prefetch            | `GOOGLEDRIVESYNC.EXE-XXXXXXX.pf`                       |
| LNK                 | Accesos directos a `googledrivesync.exe`               |
| Historial Navegador | URLs visitadas, descargas, edición.                    |
| Cache JSON (Chrome) | Identificar actividad: `"trash"`, `"drive#permission"` |
