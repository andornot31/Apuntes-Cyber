## Google Workspace (G Suite) ‚Äì Registros de Auditor√≠a

### 1. Tipos de registros

| Registro                 | Finalidad                                      | Datos incluidos                          | Retenci√≥n |
| ------------------------ | ---------------------------------------------- | ---------------------------------------- | --------- |
| **Admin**                | Actividades del administrador                  | Cuenta, evento, IP, fecha                | 6 meses   |
| **Login**                | Inicios de sesi√≥n (correo web y consola admin) | Cuenta, tipo de login, IP, fecha         | 6 meses   |
| **Email Search**         | B√∫squeda de correos (cabeceras)                | Remitente, asunto, ID mensaje, IP, fecha | 30 d√≠as   |
| **Token**                | Autorizaciones de apps y m√≥viles               | Usuario, app, √°mbito, IP, fecha          | 6 meses   |
| **Account & Apps Usage** | Uso de Gmail, Drive y apps externas            | Estado de cuenta, actividad en servicios | 6 meses   |

üü¢ **Activados por defecto** para todos los niveles de Google Workspace.  
üî¥ **Retenci√≥n limitada**, salvo con Enterprise (puede exportarse a BigQuery o SIEM para conservar m√°s tiempo).

---

### 2. Exportaci√≥n y an√°lisis

|Elemento|Detalle|
|---|---|
|**Exportaci√≥n**|Formato **CSV**|
|**APIs disponibles**|Para reenv√≠o a fuentes externas o sistemas SIEM|
|**Retraso en logs**|Algunos registros (ej. Login) pueden tener retraso de **1-2 d√≠as**|
|**Visibilidad**|Solo metadatos (no contenido del mensaje)|
|**Informaci√≥n valiosa**|IPs, apps usadas, actividad de tokens, estado post-entrega del mensaje|

---

### 3. Detalles forenses avanzados (Email Search)

- Solo se graban **cabeceras de correos** (no cuerpo).
- Permite ver:
	- Carpeta de destino
	- Etiquetas
	- Estado del mensaje (abierto, le√≠do, marcado como importante/no importante, visto/no visto,spam).
- **No visibles en CSV**: detalles como estado post-entrega y reglas de cumplimiento (solo v√≠a API/Vault).

---

## Google Workspace Vault (Enterprise y Business)

### 4. Funciones de Vault

| Funcionalidad               | Detalle                                                             |
| --------------------------- | ------------------------------------------------------------------- |
| **Retenci√≥n y eDiscovery**  | Retenci√≥n de correos, Drive, Grupos, Hangouts, Borradores           |
| **B√∫squedas**               | Por cuenta, palabras clave, tipo de dato, fechas                    |
| **Interfaz / API**          | B√∫squeda mediante panel web o API                                   |
| **Formatos de exportaci√≥n** | `.PST`, `.MBOX`, `.XML` (metadatos), `.CSV` (recuento/propietarios) |
| **Integridad**              | Se genera archivo de **hash MD5** de los resultados                 |
| **Limitaci√≥n**              | Al borrar una cuenta, se eliminan tambi√©n los datos de Vault        |

---

### 5. Casos especiales: Mensajes y Borradores

#### Modo confidencial

|Elemento|Detalle|
|---|---|
|¬øQu√© se archiva?|Contenido completo de mensajes **internos confidenciales**|
|¬øQu√© no se archiva?|Contenido confidencial enviado por terceros|
|¬øSe conserva tras caducar?|‚úÖ S√≠, incluso si fue revocado|
|¬øSe puede buscar?|‚úÖ S√≠, usando `label:confidentialmode`|

#### Borradores y versiones

|Elemento|Detalle|
|---|---|
|¬øQu√© se archiva?|Borradores y sus **versiones intermedias**|
|Duraci√≥n de versiones|30 d√≠as (incluso tras enviar o eliminar el mensaje)|
|Valor probatorio|Muestra la evoluci√≥n del mensaje; √∫til en investigaciones|
|¬øSujetos a pol√≠ticas de retenci√≥n?|‚ùå No (versiones), ‚úÖ S√≠ (borradores actuales)|

---

### 6. Recomendaciones forenses

- Exportar registros sensibles antes de que expire el per√≠odo de retenci√≥n.
- Usar Vault para b√∫squedas detalladas, incluida actividad en Drive, Grupos, borradores.
- No eliminar cuentas antes de asegurar su copia en Vault (usar suspensi√≥n).
- Supervisar mensajes en modo confidencial como posibles canales de fuga.
- Evaluar retrasos en disponibilidad de registros (1-2 d√≠as) en cronolog√≠as precisas.
- Revisar versiones de borradores en casos de mensajes manipulados o sospechosos.