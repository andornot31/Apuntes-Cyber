## Box Backup & Sync (cliente legacy de Box)

* **Qué es**: antiguo cliente de escritorio (no virtualiza; copia real en disco). Box Drive suele **desinstalarlo** al instalarse. Carpeta por defecto: `%UserProfile%\Box Sync\`. Metadatos en `%UserProfile%\AppData\Local\Box Sync\`.
* **Localiza la raíz**: `sync_root_folder.txt` guarda dónde quedó la carpeta si el usuario la movió.
* **DBs clave** (SQLite, en `%AppData%\Local\Box Sync\`):
	- `sync.db` → tabla **preferences**: `user_id`, `login_name` (email), `sync_directory_path`, `last_synced_time`, `last_attempted_update_version`.
	- `sync.db` → tabla **box\_item**: `box_id`, `parent_item_id` (cruzable), `name`, `size`, `checksum` (SHA-1), `is_deleted` (1 si ya no está local: borrado o desincronizado). **Eliminados** pueden persistir **meses**.
	- `monitor_state.db` → **box\_scanned\_item**: `sequence_id` (versionado 0=original), `is_deleted` (presente, suele no usarse).
* **Logs**: `%AppData%\Local\Box Sync\Logs` → `Box Sync-<versión>.log`: incluye `LOGIN_NAME`, `LAST_SYNCED_TIME`; busca **“Creating file”**, **“Delete file”**, **“Retrieving item”**, **“path=”**. Tamaño hasta \~20 MB; \~1 mes.

---

## Sincronización y marcas de tiempo (comparativa entre clientes)

* **Modificación** se conserva en todas; **creación** suele ponerse a **hora de sincronización** excepto en **Google Drive for Desktop** y **Box Backup & Sync** (sí preservan la creación). **Acceso** lo actualizan Dropbox, Google Drive Desktop y Box Drive; **solo** Google Drive Desktop lo mantiene entre dispositivos.

| Aplicación                   | Creación               | Modificación | Acceso               |   |
| ---------------------------- | ---------------------- | ------------ | -------------------- | - |
| OneDrive / OneDrive Business | Hora de sincronización | Preservado   | —                    |   |
| Google Drive for Desktop     | **Preservado**         | Preservado   | Actualiza y conserva |   |
| Dropbox                      | Hora de sincronización | Preservado   | Actualiza            |   |
| Box Drive                    | Hora de sincronización | Preservado   | Actualiza            |   |
| Box Backup & Sync            | **Preservado**         | Preservado   | —                    |   |

---

## KAPE — objetivos para nube (adquisición rápida)

* **Targets incluidos por defecto** para OneDrive, Google Drive, Dropbox y Box; separados en **Metadatos** y **Archivos de usuario** (evita traer gigas innecesarios). Compuestos: `CloudStorage_Metadata.tkape` y `CloudStorage_All.tkape`.
* **Advertencias**:
	- Pedir ficheros en **carpetas virtuales** (DriveFS/Box Drive) puede **disparar descargas** desde la nube. Considera aislar el equipo o copiar manualmente solo locales.
	- Targets asumen **rutas por defecto**; si el usuario movió/renombró, **ajústalos** (p. ej., `info.json` de Dropbox revela la ruta real).
* **Uso**: KAPE en vivo, imagen montada o remoto (con F-Response). Puede procesar **Shadow Copies** y subir salida a **SFTP/AWS/Azure**.

---

## Recolección en la nube mediante API (eDiscovery)

* **Herramientas/servicios**: Microsoft 365 eDiscovery, EnCase, NUIX, **Google Takeout** (Drive, Fotos, Chrome, etc.), **Magnet AXIOM** (soporta múltiples proveedores e incluye **registros** si la API lo permite), **F-Response** (monta a VHD/SMB). **Requieren credenciales** (y 2FA si aplica).
* **Limitaciones**: puede **faltarte** el **historial de versiones** vía API; alternativa práctica: **capturas** de la interfaz web mientras navegas por versiones si solo son pocos archivos.

---

## Identificación vía artefactos del navegador (OSINT local)

* **Por qué**: aunque no tengas todo el contenido de la nube, las **URLs** y **títulos** de las páginas revelan **acción** (compartir, borrar, versiones), **IDs** de archivos, **carpetas** y hasta **emails**/usuarios.
* **Pistas**: parámetros con `cid` (OneDrive), IDs de Drive/Box/Dropbox, búsquedas web del usuario, vistas de **Elementos eliminados** y **versionado**. Cruza IDs con DBs locales (p. ej., DriveFS `metadata_sqlite_db`).
* **Borrados del navegador**: aun así suelen quedar DBs (Chrome/Firefox). Recupera **registros borrados** buscando **gaps** de IDs y en **espacio no asignado**; la desinstalación no elimina DBs del perfil.

---

## Identificación vía artefactos del sistema operativo (Windows)

* Revisa: **Shadow Copies**, **LNK/Jump Lists**, **“files opened”**, **RecentDocs**, **Office MRUs**, **OpenSavePidlMRU**, **ShellBags**, **Índices de directorio**, **IE History**, **Prefetch**, **Papelera**, **memoria** (cachés). Estas fuentes ayudan a demostrar **existencia histórica** incluso en **carpetas virtuales** (DriveFS/Box Drive).

---

## Resumen forense del almacenamiento en la nube (qué esperar por app)

* **Metadatos locales**: todas las apps mantienen alguna DB sobre lo **local** (valioso si la carpeta virtual no es accesible en frío).
* **Metadatos de nube**: críticos para listar **solo-nube** (lo que no está local). Guían decisiones de adquisición.
* **Hashes**: varias DBs incluyen **hashes** (p. ej., SHA-1 en Box, MD5 en algunos Google/Dropbox antiguos), permiten identificar ficheros sin copias.
* **Eliminados en DB**: pocas apps los retienen en metadatos; si no, mira **logs de uso**.
* **Cachés accesibles**: **DriveFS** y **Box Drive** guardan contenido recuperable en disco (útil para **solo-nube** o **eliminados**).
* **Sistemas de archivos virtuales**: solo **DriveFS** y **Box Drive**; extremar cuidado en adquisiciones (descargas involuntarias).

---

## Automatización del análisis de SQLite

* **SQLECmd (Eric Zimmerman)**: usa **map files** para reconocer DBs conocidas, parsea **recursivamente** (archivo o carpeta), **convierte tiempos** y exporta a **CSV**; ideal para barrer perfiles completos e imágenes montadas. Ahorra revisar tabla por tabla.
* **Contexto**: el “agotamiento SQLite” es real (móviles, navegadores, nube). Complementa con **carving** de SQLite si sospechas borrado.

---

## Mini-checklist de triaje (multi-nube)

1. **Inventario rápido**: ¿DriveFS/Box Drive virtual? ¿Rutas reales (Dropbox `info.json`, Box `sync_root_folder.txt`)?
2. **DBs**: DriveFS `metadata_sqlite_db`; Dropbox `home.db/sync_history.db/nucleus.sqlite3/aggregation.dbx`; Box (`sync.db`, `streemsfs.db`/`streemsfs.db`).
3. **Caché**: DriveFS `content_cache`; Box `…\cache` (+ `streemsfs.db` → `cacheDataId`).
4. **Logs/uso**: Box `Box_Streem*`; Dropbox `sync_history.db`; OneDrive `SyncDiagnostics.log`; Workspace/365 UAL si aplica.
5. **Navegador + SO**: URLs/IDs/acciones ↔ LNK/Jump/RecentDocs/Shadow Copies/Papelera.
6. **KAPE/API**: targets de **Metadatos** primero; API/Takeout/eDiscovery si necesitas nube; documenta **limitaciones** (versionado, descargas).