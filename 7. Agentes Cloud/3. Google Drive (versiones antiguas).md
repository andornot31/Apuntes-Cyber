## Visión general y rutas clave

* Cliente “**Google Drive**” (pre-DriveFS), también conocido como **Backup and Sync** en su etapa final de vida. Sus artefactos viven bajo:
  `\Users\<usuario>\AppData\Local\Google\Drive\user_default`.
* La **carpeta sincronizada** típica era real (no virtual): `C:\Users\<usuario>\Google Drive`, con contenido local “plano” idéntico —o casi— al de la nube (útil para triage y Shadow Copies).

## Bases de datos y logs principales

### a) `Snapshot.db` (SQLite3)

* Ubicación: `...\Google\Drive\user_default\Snapshot.db`. Registra lo sincronizado. Tabla clave: **cloud\_entry**.
  Campos esenciales:
	- `filename` (nombre del fichero) y `modified` (epoch, **UTC**).
	- `checksum` (**MD5** del fichero) y `size` (bytes).
* Topología local: tablas **local\_entry** (inodes) y **local\_relations** (relación carpeta↔fichero) mapean la jerarquía (parent/child).
* **Borrados**: si falta información en tablas activas, intenta **recuperación de registros SQLite** (carved records).

### b) `sync_log.log`

* Log operativo del agente: rutas sincronizadas, **timestamps**, **MD5**, **cuenta Gmail** asociada y **dirección de flujo** (sube/baja).
  Indicadores útiles:
	- `Action.DELETE` (borrado detectado).
	- `Direction.Upload` / `Direction.Download`.

### c) `Cloud_graph\Cloud_graph.db` (SQLite)

* Tabla clave: **cloud\_graph\_entry**. Aporta **nombre**, **tamaño**, **modified (epoch UTC)** y **MD5** del fichero sincronizado.

### d) `Sync_config.db` (SQLite)

* Única tabla: **data**. Guarda **email de la cuenta**, **ubicación de carpetas compartidas** y **versión** del cliente instalado.

> Tip: Estas DBs se visualizan y consultan cómodamente con **SQLite Studio** (mencionado en el material).

## Evidenciar ejecución del cliente

* **Eventos de Aplicación**: `C:\Windows\System32\winevt\Logs\Application.evtx`, **Event ID 1033** (“Windows Installer installed the product”).
* **Prefetch**: `GOOGLEDRIVESYNC.EXE-XXXXXXXX.pf`.
* **Accesos directos (LNK)**: a `C:\Program Files\Google\Drive\googledrivesync.exe`.

## “Identificar en la navegación” y artefactos del SO

* En artefactos del **navegador**/SO (LNK, Jump Lists, MRUs, Papelera) busca rutas y cadenas como **“Google Drive”** (y, si coexistió con el cliente nuevo, “**My Drive**”). Esto ayuda a probar **existencia histórica** y letras/unidades asociadas.

## Procedimiento sugerido (checklist)

1. **Localiza el perfil** del agente antiguo: `...\Google\Drive\user_default`. Confirma existencia de **Snapshot.db**, **sync\_log.log**, **Cloud\_graph.db** y **Sync\_config.db**. 
2. **Inventario por DB**:
	- `Snapshot.db` → tabla **cloud\_entry** (nombre, **modified** UTC, **MD5**, **size**).
	- Cruza con **local\_entry/local\_relations** para reconstruir la **jerarquía** (parent/child).
3. **Actividad reciente**: parsea **sync\_log.log** para ver **subidas/bajadas**, **borrados** y **MD5** involucrados; anota la **cuenta Gmail**.
4. **Cloud\_graph.db**: valida **modified UTC**, **size** y **MD5** por elemento; útil cuando `Snapshot.db` está incompleta.
5. **Configuración**: extrae **email** y **versiones** desde `Sync_config.db` (tabla **data**) y mapea **carpetas compartidas**.
6. **Ejecución del binario**: confirma con **Application.evtx (1033)**, **Prefetch** y **LNK** al ejecutable.
7. **Correlación SO/Navegador**: busca “Google Drive” en LNK/JumpLists/Papelera y en el **historial del navegador** para demostrar **existencia/uso**.
8. **Recuperación**: si faltan entradas, intenta **carving** de registros en `Snapshot.db` (SQLite).

## Tabla rápida “Qué buscar / Dónde / Para qué”

| Qué                        | Dónde                                                                                | Para qué                                                                     |
| -------------------------- | ------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------- |
| Perfil del agente          | `...\Google\Drive\user_default`                                                      | Punto de partida: DBs y logs del cliente antiguo.                            |
| Catálogo de contenidos     | `Snapshot.db` → `cloud_entry` (+ `local_entry` / `local_relations`)                  | Nombres, **modified (UTC)**, **MD5**, **size** y estructura padre-hijo.      |
| Diario de sincronización   | `sync_log.log`                                                                       | **MD5**, **rutas**, **DELETE**, **Upload/Download**, **cuenta Gmail**.       |
| Vista “gráfica” de objetos | `Cloud_graph\Cloud_graph.db` → `cloud_graph_entry`                                   | **Nombre**, **modified (UTC)**, **size**, **MD5** (otra fuente).             |
| Configuración del cliente  | `Sync_config.db` (tabla `data`)                                                      | **Email**, **carpetas compartidas**, **versión** del cliente.                |
| Evidencia de ejecución     | `Application.evtx` (ID 1033), **Prefetch** `GOOGLEDRIVESYNC.EXE`, **LNK** al binario | Demostrar instalación/uso en el endpoint.                                    |
| Navegación/OS              | Artefactos de navegador y SO (LNK, Jump Lists, Papelera)                             | Probar existencia histórica y rutas asociadas (“Google Drive”, “My Drive”).  |

## Notas y “gotchas”

* **Epoch** en campos de tiempo (p. ej., `modified`) es **UTC**: conviértelo antes de hacer la línea temporal.
* Si `Snapshot.db` está **truncada** o falta, **`sync_log.log`** y **`Cloud_graph.db`** suelen salvar el caso (nombres, MD5, flujos).
* La carpeta **Google Drive** era **real** (no FS virtual): recuerda revisar **Shadow Copies** para versiones previas.