## Protocolos de Transferencia

| Protocolo                           | Descripci√≥n breve                                                                                                            | Acceso forense directo                           |
| ----------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------ |
| **Mass Storage Device (MSD)**       | Expone el dispositivo como un volumen completo (como un disco duro o USB) al sistema. Se asigna una letra de unidad.         | ‚úÖ S√≠ ‚Äì acceso completo al sistema de archivos    |
| **Picture Transfer Protocol (PTP)** | Dise√±ado para c√°maras digitales. Solo permite acceso a im√°genes u objetos multimedia. No monta volumen.                      | ‚ùå No ‚Äì acceso limitado a archivos (no raw FS)    |
| **Media Transfer Protocol (MTP)**   | Extiende PTP, usado por smartphones. Permite transferir diferentes tipos de archivos, pero no expone el sistema de archivos. | ‚ùå No ‚Äì no se puede hacer imagen forense completa |

---

### Recolecci√≥n Forense de Informaci√≥n de Dispositivos USB

| √çtem                         | ¬øC√≥mo obtenerlo?                                                                                                                                                                                                                                                            | Protocolo compatible |
| ---------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------- |
| **USBStor** (historial)      | `HKLM\SYSTEM\ControlSet001\Enum\USBSTOR` ‚Üí muestra dispositivos conectados                                                                                                                                                                                                  | ‚úÖ MSD / MTP / PTP    |
|                              | Cada subclave representa un dispositivo: contiene VID, PID, n√∫mero de serie, fechas                                                                                                                                                                                         |                      |
| **VID/PID**                  | - Registro: `HKLM\SYSTEM\ControlSet001\Enum\USB\VID_xxxx&PID_xxxx`                                                                                                                                                                                                          | ‚úÖ MSD                |
|                              | - Tambi√©n aparece en `USBSTOR` como parte de la clave                                                                                                                                                                                                                       |                      |
| **Nombre del volumen**       | - `HKLM\SOFTWARE\Microsoft\Windows Portable Devices\Devices`                                                                                                                                                                                                                | ‚úÖ MSD / MTP / PTP    |
|                              | - Usando `vol` desde la l√≠nea de comandos si el dispositivo est√° conectado                                                                                                                                                                                                  |                      |
| **Letra de unidad asignada** | `HKCU\System\MountedDevices` -> discos de almacenamiento externos y √∫ltima unidad asignada                                                                                                                                                                                  | ‚úÖ MSD                |
|                              | Entradas como `##Volume{GUID}` mostrar√°n letra y volumen                                                                                                                                                                                                                    | ‚ùå MTP / PTP          |
| **Usuario**                  | 1. Localizar el GUID del Volumen en `SYSTEM\mountedDevices`                                                                                                                                                                                                                 | ‚úÖ MSD / MTP / PTP    |
|                              | 2. Asociar el GUID al usuario en el registro:<br>- `NTUSER.DAT\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2`                                                                                                                                             |                      |
| **Volumen Serial**           | `Software\Microsoft\Windows NT\CurrentVersion\EMDMgmt`                                                                                                                                                                                                                      | ‚úÖ MSD                |
|                              |                                                                                                                                                                                                                                                                             | ‚ùå MTP / PTP          |
| **Timestamps de conexi√≥n**   | `USBSTOR\{VEN_PROD_VERSION}\{USBserial}\Properties\{id}` ‚Üí<br>- Win7 y Win8 -> Primera conexi√≥n -> 0064<br>- Win8 en adelante -> Ultima conexi√≥n -> 0066<br>- Win8 en adelante -> Fecha de desconexi√≥n con independencia de si es quitado con seguridad o sin ella. -> 0067 | ‚úÖ MSD / MTP / PTP    |
|                              | Tambi√©n puede usarse el archivo de log: `C:\Windows\inf\setupapi.dev.log`<br>- XP -> `C:\Windows\setupapi.log`<br>- Win7-Win10 -> `C:\Windows\inf\setupapi.dev.log`                                                                                                         |                      |

---

## üõ† Herramientas recomendadas

| Herramienta             | Uso principal                                                            |
| ----------------------- | ------------------------------------------------------------------------ |
| **USB Detective**       | An√°lisis forense de artefactos USBStor, SetupAPI, MountPoints2           |
| **Registry Explorer**   | Manual inspection of `USBSTOR`, `MountedDevices`, `MountPoints2`         |
| **RECmd / RegRipper**   | Plugins para extraer claves de inter√©s relacionadas con USB              |
