## Qué es y para qué sirve

* **Análisis Forense Digital**: disciplina para **identificar, asegurar, analizar, extraer y presentar** evidencias digitales con procedimientos que permitan su aceptación legal.
* Dos enfoques habituales:
	- **Respuesta a Incidentes (IR)**: incidente en curso, entorno cambiante, objetivo = **contener/erradicar**; la **identificación** correcta es crítica (ejecución, persistencia, movimientos laterales).
	- **Pericial**: incidente pasado, análisis **repetible** y **documentado** para juzgado (cómo/cuándo/dónde/por qué).
* **Principio de Locard**: todo contacto deja rastro (aplícalo a USBs: fechas, carpetas, marca/modelo, nº de serie).

## Metodologías y fases (qué seguir)

* Referencias: **RFC 3227**, **ISO 27037**, **NIST 800-66**. Se propone usar **ISO 27037** como base (identificación, recopilación, adquisición, **preservación**, **cadena de custodia**).
* **Documenta siempre** la “contaminación” al ejecutar herramientas en vivo (qué se ejecutó, cuándo y efectos).

## Tipos de evidencias (visión rápida)

* **HDD/SSD**, **pendrives/tarjetas**: distintos comportamientos y necesidades de adquisición.

## Tipos de **adquisición**

* **Lógica (por volumen/partición)**: copia bit-a-bit del volumen (incluye espacio libre). Suele hacerse **post-mortem**.
* **Física (de disco completo)**: imagen de todo el dispositivo (todas las particiones + sectores de arranque). Clonado ↔ Imagen forense.
* **De ficheros/carpeta (triaje)**: conjunto selectivo de artefactos relevantes (sin espacio libre).

## Formatos de **imagen forense**

* **RAW (.001/.dd)**: datos puros + TXT con metadatos.
* **E01 (EnCase 6)**: metadatos en el propio contenedor (header/footer, CRC, compresión zlib).
* **Ex01 (EnCase 7)**: compresión **bzip**, CRC al final; firma “EVF” visible en hex.
* **AFF/AFF4**: compresión/cifrado/firma; soporta dividir datos y metadatos.
* **AD1**: contenedor de **contenido de carpeta** (sin metadatos del FS ni espacio libre).

## Herramientas y soporte de adquisición

* **Clonadoras** (con bloqueador HW integrado) y **bloqueadores de escritura** (HW/SW) para preservar integridad.
* **FTK Imager** (crear/verificar imágenes), **Magnet Acquire** (PC y móviles), **Arsenal Image Mounter** (montaje de imágenes y BitLocker).
* **Verificación de hash** (MD5/SHA) de la imagen recibida antes de analizar.
* **SSD**: el módulo dedica apartado específico (considera su tratamiento particular).

## Adquisición **en vivo** (sistemas encendidos)

* **Memoria RAM**: prioritaria por claves/artefactos volátiles (procesos, puertos, credenciales, SAM en caché, etc.). Herramientas: FTK Imager, Magnet/Belkasoft RAM Capture, DumpIt, WinPmem. **Drivers firmados** en x64; AV/HIPS pueden interferir.
* **Detección de cifrado**: **Magnet Encrypted Disk Detector** (BitLocker, TrueCrypt/VeraCrypt, PGP, SafeBoot). Si hay cifrado y no hay claves → prioriza **triaje**.
* **Triaje/KAPE** (Eric Zimmerman):
	- **Target Options**: define **qué** rutas adquirir; contenedores **ZIP/VHD/VHDX**, **Deduplicate** en Shadow Copies; puede **subir** resultados a **SFTP/AWS/Azure**.
	- **Module Options**: procesado de artefactos y ejecución de utilidades (p.ej., **Bitlocker-key**, **EDD**, **WinPmem**).
	- Recomendación práctica: dejar **SANS\_Triage** si no ajustas listas.

## Flujo recomendado (regla práctica 5 pasos)

1. **RAM**, 2) **Volátiles**, 3) **Detección de cifrado**, 4) **Imagen física**, 5) **Análisis** de lo adquirido.

---

## Mini-checklist (para aplicar rápido)

* **Metodología**: ISO 27037 (identificar-recopilar-adquirir-preservar-custodia).
* **Bloqueo de escritura** y **registro de acciones** (contaminación).
* **Elegir adquisición**: lógica/física/triaje según objetivo y tiempo.
* **Formato**: E01/Ex01/RAW/AFF/AD1 según necesidades (compresión, metadatos).
* **En vivo**: RAM + EDD + KAPE (Targets/Modules, Shadow Copies, export a SFTP/AWS/Azure).
* **Verifica hashes** antes de trabajar la imagen.